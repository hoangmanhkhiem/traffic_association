(()=>{"use strict";const e={};"undefined"!=typeof lpDataAdmin&&(e.admin={apiAdminNotice:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/admin-notices",apiAdminOrderStatic:lpDataAdmin.lp_rest_url+"lp/v1/orders/statistic",apiAddons:lpDataAdmin.lp_rest_url+"lp/v1/addon/all",apiAddonAction:lpDataAdmin.lp_rest_url+"lp/v1/addon/action",apiAddonsPurchase:lpDataAdmin.lp_rest_url+"lp/v1/addon/info-addons-purchase",apiSearchCourses:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/search-course",apiSearchUsers:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/search-user",apiAssignUserCourse:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/assign-user-course",apiUnAssignUserCourse:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/unassign-user-course",apiAJAX:lpDataAdmin.lp_rest_url+"lp/v1/load_content_via_ajax/"}),"undefined"!=typeof lpData&&(e.frontend={apiWidgets:lpData.lp_rest_url+"lp/v1/widgets/api",apiCourses:lpData.lp_rest_url+"lp/v1/courses/archive-course",apiAJAX:lpData.lp_rest_url+"lp/v1/load_content_via_ajax/"});const t=e;let a,s,n,o;const l=window.location.search,c=new URLSearchParams(l),i=c.get("tab");let r;const d=[],p=(e,t)=>{const a=r.querySelector(".lp-notify-action").cloneNode(!0);a.classList.remove("clone"),r.insertBefore(a,r[0]);const s=a.querySelector(`.${a.classList.value}__success`),n=a.querySelector(`.${a.classList.value}__error`);"success"===e?(s.classList.add("show"),s.querySelector(".message").innerHTML=t):(n.classList.add("show"),n.querySelector(".message").innerHTML=t),r.classList.add("show"),setTimeout((()=>{a.remove(),1===r.querySelectorAll(".lp-notify-action").length&&r.classList.remove("show")}),"success"===e?3e3:4e3)};((e="")=>{const a=i?`?tab=${i}`:`?${e}`;fetch(t.admin.apiAddons+a,{method:"GET",headers:{"X-WP-Nonce":lpDataAdmin.nonce}}).then((e=>e.json())).then((e=>{const{status:t,message:a,data:o}=e;"success"===t?(s=o.html,n=o.addons):s=a})).catch((e=>{console.log(e)}))})();const u=e=>{e<4?o.classList.add("max-3-items"):o.classList.remove("max-3-items")},v=setInterval((()=>{if(a||r){if(s&&a&&r){a.innerHTML=s,o=a.querySelector("#lp-addons");const e=document.querySelector(".lp-nav-tab-wrapper"),t=e.cloneNode(!0);a.insertBefore(t,a.children[0]),t.style.display="flex",e.remove();const n=t.querySelector(".nav-tab.nav-tab-active span");u(parseInt(n.textContent)),clearInterval(v)}}else a=document.querySelector(".lp-addons-page"),r=document.querySelector(".lp-notify-action-wrapper")}),1);document.addEventListener("DOMContentLoaded",(e=>{})),document.addEventListener("click",(e=>{const s=e.target;if("span"===s.tagName.toLowerCase()){e.preventDefault();const t=s.closest(".btn-addon-action");t&&t.click()}if(s.classList.contains("btn-addon-action")){e.preventDefault(),s.classList.add("handling");let a="";const o=s.closest(".lp-addon-item"),l=n[o.dataset.slug],c=s.dataset.action,i=o.querySelector(".lp-addon-item__purchase");if("purchase"===c)return i.style.display="block",void(i.querySelector(".purchase-install").style.display="flex");if("update-purchase-code"===c)return i.querySelector(".purchase-update").style.display="flex",void(i.style.display="block");if("buy"===c){const e=s.dataset.link;return void window.open(e,"_blank")}if("cancel"===c)return void(i.style.display="none");if("install"===c&&s.dataset.link){s.classList.remove("handling");const e=s.dataset.link;return void window.open(e,"_blank")}i&&(a=i.querySelector("input[name=purchase-code]").value),((e,a)=>{const s=e.addon.slug;-1===d.indexOf(s)&&(d.push(s),fetch(t.admin.apiAddonAction,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":lpDataAdmin.nonce},body:JSON.stringify({...e})}).then((e=>e.json())).then((e=>{const t=d.indexOf(s);-1!==t&&d.splice(t,1);const{status:n,message:o,data:l}=e;a&&a(n),p(n,o)})).catch((e=>{p("error",`error js: ${e}`),console.log(e)})))})({purchase_code:a,action:c,addon:l},(function(e,t,a){if("success"===e)if("install"===c){o.classList.add("installed","activated"),o.classList.remove("not_installed"),i.style.display="none";const e=document.querySelector(".nav-tab[data-tab=installed] span");e.textContent=parseInt(e.textContent)+1;const t=document.querySelector(".nav-tab[data-tab=not_installed] span");t.textContent=parseInt(t.textContent)-1}else"update"===c?(o.querySelector(".addon-version-current").innerHTML=l.version,o.classList.remove("update")):"activate"===c?o.classList.add("activated"):"deactivate"===c&&o.classList.remove("activated");s.classList.remove("handling")}))}if(s.classList.contains("nav-tab")){e.preventDefault(),document.querySelectorAll(".nav-tab").forEach((function(e){e.classList.remove("nav-tab-active")})),s.classList.add("nav-tab-active");const t=s.dataset.tab,n=a.querySelectorAll(".lp-addon-item");a.querySelector("#lp-search-addons__input").value="",c.set("tab",t),window.history.pushState({},"",`${window.location.pathname}?${c.toString()}`);let o=0;n.forEach((e=>{e.classList.remove("search-not-found"),"all"===t||e.classList.contains(t)?(e.classList.remove("hide"),o++):e.classList.add("hide")})),u(o)}})),document.addEventListener("input",(e=>{const t=e.target;if("lp-search-addons__input"===t.id&&(e=>{const t=a.querySelectorAll(".lp-addon-item");let s=0;t.forEach((t=>{const a=t.querySelector("a").textContent;t.classList.contains("hide")||(a.toLowerCase().includes(e.toLowerCase())?(t.classList.remove("search-not-found"),s++):t.classList.add("search-not-found"))})),u(s)})(t.value),t.classList.contains("enter-purchase-code")){e.preventDefault();const a=t.value,s=t.closest(".lp-addon-item__purchase");s&&(s.querySelector("input[name=purchase-code]").value=a)}}))})();