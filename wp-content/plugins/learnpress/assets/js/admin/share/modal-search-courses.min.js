const _=window._;window.$Vue=window.$Vue||window.Vue,jQuery(document).ready((function(e){const s=!!$Vue&&$Vue.http;document.getElementById("vue-modal-search-items")&&$Vue&&($Vue.component("learn-press-modal-search-items",{template:"#learn-press-modal-search-items",data:()=>({paged:1,term:"",hasItems:!1,selected:[]}),watch:{show(s){s&&e(this.$refs.search).focus()}},props:["postType","context","contextId","show","callbacks","exclude"],created(){},mounted(){this.term="",this.paged=1,this.search()},methods:{doSearch(e){this.term=e.target.value,this.paged=1,this.search()},search:_.debounce((function(t){e("#modal-search-items").addClass("loading");const a=this;s.post(window.location.href,{type:this.postType,context:this.context,context_id:this.contextId,term:t||this.term,paged:this.paged,exclude:this.exclude,"lp-ajax":"modal_search_items",nonce:lpGlobalSettings.nonce},{emulateJSON:!0,params:{}}).then((function(s){const t=LP.parseJSON(s.body||s.bodyText);a.hasItems=!!_.size(t.items),e("#modal-search-items").removeClass("loading"),e(a.$el).find(".search-results").html(t.html).find('input[type="checkbox"]').each((function(){const s=parseInt(e(this).val());_.indexOf(a.selected,s)>=0&&(this.checked=!0)})),_.debounce((function(){e(a.$el).find(".search-nav").html(t.nav).find("a, span").addClass("button").filter("span").addClass("disabled")}),10)()}))}),500),loadPage(s){s.preventDefault();const t=e(s.target);if(!t.find(".page-numbers").hasClass("disabled")&&!t.is("span")){if(t.hasClass("next"))this.paged++;else if(t.hasClass("prev"))this.paged--;else{const e=t.html();this.paged=parseInt(e)}this.search()}},selectItem(s){const t=e(s.target).closest("li").find('input[type="checkbox"]'),a=parseInt(t.val()),c=_.indexOf(this.selected,a);t.is(":checked")?-1===c&&this.selected.push(a):c>=0&&this.selected.splice(c,1)},addItems(){this.callbacks&&this.callbacks.addItems&&this.callbacks.addItems.call(this),e(document).triggerHandler("learn-press/add-order-items",this.selected)},close(){this.$emit("close")}}}),window.LP.$modalSearchItems=new $Vue({el:"#vue-modal-search-items",data:{show:!1,term:"",postType:"",callbacks:{},exclude:"",context:""},methods:{open(e){_.each(e.data,(function(e,s){this[s]=e}),this),this.callbacks=e.callbacks,this.focusSearch()},close(){this.show=!1},focusSearch:_.debounce((function(){e('input[name="search"]',this.$el).focus()}),200)}}))}));